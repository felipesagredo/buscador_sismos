(function(){"use strict";var e={3408:function(e,a,t){var n=t(9242),o=t(3396);function r(e,a,t,n,r,i){const s=(0,o.up)("HelloWorld");return(0,o.wg)(),(0,o.j4)(s)}var i=t(7139);const s=e=>((0,o.dD)("data-v-1aefac13"),e=e(),(0,o.Cn)(),e),l={class:"app-container"},u=s((()=>(0,o._)("div",{id:"map",class:"map-container"},null,-1))),c=s((()=>(0,o._)("h1",null,"Buscador de movimientos tel√∫ricos",-1))),d={class:"input-container"},m=s((()=>(0,o._)("label",{for:"fechaInicio"},"Fecha de Inicio:",-1))),h=["max"],p=s((()=>(0,o._)("label",{for:"fechaTermino"},"Fecha de T√©rmino:",-1))),f=["max"],g=s((()=>(0,o._)("label",{for:"magnitudMin"},"Magnitud M√≠nima:",-1))),v=s((()=>(0,o._)("label",{for:"magnitudMax"},"Magnitud M√°xima (opcional):",-1))),b={key:0,class:"justified-table"},w=s((()=>(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"Lugar"),(0,o._)("th",null,"Magnitud"),(0,o._)("th",null,"Fecha")])],-1))),k=["onClick"],M={key:1},y={class:"confirm-dialog"},_=s((()=>(0,o._)("h3",null,"‚ö†Ô∏è Muchos resultados encontrados",-1))),C=s((()=>(0,o._)("p",{class:"warning-text"},"Cargar todos estos resultados puede:",-1))),D=s((()=>(0,o._)("ul",null,[(0,o._)("li",null,"Tomar varios segundos en cargar"),(0,o._)("li",null,"Ralentizar el navegador"),(0,o._)("li",null,"Consumir m√°s recursos de la API")],-1))),q={class:"dialog-buttons"};function T(e,a,t,r,s,T){return(0,o.wg)(),(0,o.iD)("div",l,[u,c,(0,o._)("div",d,[m,(0,o.wy)((0,o._)("input",{type:"date",id:"fechaInicio","onUpdate:modelValue":a[0]||(a[0]=e=>s.fechaInicio=e),max:s.fechaMaxima},null,8,h),[[n.nr,s.fechaInicio]]),p,(0,o.wy)((0,o._)("input",{type:"date",id:"fechaTermino","onUpdate:modelValue":a[1]||(a[1]=e=>s.fechaTermino=e),max:s.fechaMaxima},null,8,f),[[n.nr,s.fechaTermino]]),g,(0,o.wy)((0,o._)("input",{type:"number",id:"magnitudMin","onUpdate:modelValue":a[2]||(a[2]=e=>s.magnitudMin=e),step:"0.1",min:"0",placeholder:"Ej: 4.2"},null,512),[[n.nr,s.magnitudMin]]),v,(0,o.wy)((0,o._)("input",{type:"number",id:"magnitudMax","onUpdate:modelValue":a[3]||(a[3]=e=>s.magnitudMax=e),step:"0.1",min:"0",placeholder:"Ej: 7.5"},null,512),[[n.nr,s.magnitudMax]]),(0,o._)("button",{onClick:a[4]||(a[4]=(...e)=>T.buscarTerremotos&&T.buscarTerremotos(...e))},"Buscar"),(0,o._)("button",{onClick:a[5]||(a[5]=(...e)=>T.limpiarMapa&&T.limpiarMapa(...e)),class:"clear-button"},"üóëÔ∏è Limpiar Mapa")]),s.earthquakes.length?((0,o.wg)(),(0,o.iD)("table",b,[w,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.earthquakes,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.id,onClick:a=>T.ubicarSismo(e),class:"clickable-row"},[(0,o._)("td",null,(0,i.zw)(e.properties.place),1),(0,o._)("td",null,(0,i.zw)(e.properties.mag),1),(0,o._)("td",null,(0,i.zw)(T.formatDate(e.properties.time)),1)],8,k)))),128))])])):((0,o.wg)(),(0,o.iD)("p",M,"No se encontraron Sismos para el rango de fechas seleccionado.")),s.showConfirmDialog?((0,o.wg)(),(0,o.iD)("div",{key:2,class:"confirm-dialog-overlay",onClick:a[8]||(a[8]=(0,n.iM)(((...e)=>T.cancelarBusqueda&&T.cancelarBusqueda(...e)),["self"]))},[(0,o._)("div",y,[_,(0,o._)("p",null,[(0,o.Uk)("Se encontraron aproximadamente "),(0,o._)("strong",null,(0,i.zw)(s.estimatedCount),1),(0,o.Uk)(" sismos para los filtros seleccionados.")]),C,D,(0,o._)("div",q,[(0,o._)("button",{onClick:a[6]||(a[6]=(...e)=>T.continuarBusqueda&&T.continuarBusqueda(...e)),class:"confirm-button"},"Continuar de todas formas"),(0,o._)("button",{onClick:a[7]||(a[7]=(...e)=>T.cancelarBusqueda&&T.cancelarBusqueda(...e)),class:"cancel-button"},"Cancelar")])])])):(0,o.kq)("",!0)])}t(560);var x=t(4161),P=t(3153),j=t.n(P),B={data(){const e=e=>{const a=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${a}-${t}-${n}`},a=new Date,t=new Date;t.setDate(a.getDate()-1);const n=new Date;return n.setDate(a.getDate()+1),{fechaInicio:e(t),fechaTermino:e(a),fechaMaxima:e(n),magnitudMin:"4.2",magnitudMax:"",earthquakes:[],map:null,popupTemplate:null,markers:{},pendingTimeouts:[],showConfirmDialog:!1,estimatedCount:0,searchParams:null}},mounted(){const e=j().canvas({padding:.5});this.map=j().map("map",{zoomAnimation:!1,fadeAnimation:!0,markerZoomAnimation:!1,minZoom:2,renderer:e,preferCanvas:!0}).setView([-36.820087,-73.04428],3),j().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",updateWhenIdle:!1}).addTo(this.map),this.map.whenReady((()=>{this.popupTemplate=j().popup(),this.buscarTerremotos()}))},methods:{getColor(e){return e>7?"#d32f2f":e>6?"#f44336":e>5?"#ff9800":e>4?"#1fb976":"#4caf50"},limpiarMapa(){this.pendingTimeouts.forEach((e=>clearTimeout(e))),this.pendingTimeouts=[],this.map.eachLayer((e=>{e instanceof j().CircleMarker&&this.map.removeLayer(e)})),this.markers={},this.earthquakes=[]},buscarTerremotos(){if(this.fechaInicio&&this.fechaTermino){this.limpiarMapa();const e=this.fechaInicio,a=this.fechaTermino,t=this.magnitudMin||"0";let n=`https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&starttime=${e}&endtime=${a}&minmagnitude=${t}`;if(null!==this.magnitudMax&&void 0!==this.magnitudMax&&""!==this.magnitudMax){const e=String(this.magnitudMax).trim();""!==e&&(n+=`&maxmagnitude=${e}`)}this.searchParams={url:n,startDate:e,endDate:a,minMagnitude:t};const o=n+"&limit=1";x.Z.get(o).then((e=>{let a=0;e.data&&e.data.metadata?(a=e.data.metadata.count||0,console.log("Metadata recibido:",e.data.metadata),console.log("Total de resultados:",a)):(console.warn("No se encontr√≥ metadata en la respuesta. Procederemos con la b√∫squeda y verificaremos despu√©s."),a=0),a>20&&a>0?(this.estimatedCount=a,this.showConfirmDialog=!0,console.log("Mostrando di√°logo de confirmaci√≥n para",a,"resultados"),console.log("showConfirmDialog:",this.showConfirmDialog)):0===a?(console.log("No se pudo obtener el conteo del metadata. Procediendo con b√∫squeda y verificando despu√©s."),this.ejecutarBusqueda()):(console.log("Procediendo directamente con",a,"resultados"),this.ejecutarBusqueda())})).catch((e=>{console.error("Error al verificar cantidad de resultados:",e),console.error("Detalles del error:",e.response?.data||e.message),this.ejecutarBusqueda()}))}},ejecutarBusqueda(){if(!this.searchParams)return;this.showConfirmDialog=!1;const{url:e}=this.searchParams;x.Z.get(e).then((e=>{const a=e.data.features||[];if(a.length>20)return this.estimatedCount=a.length,this.showConfirmDialog=!0,this.searchParams.allEarthquakes=a,void console.log("Mostrando di√°logo despu√©s de recibir",a.length,"resultados");this.earthquakes=a,this.procesarSismos()})).catch((e=>{console.error("Error:",e),alert("Error al buscar sismos. Por favor, verifica tu conexi√≥n a internet e intenta nuevamente.")}))},procesarSismos(){this.earthquakes&&0!==this.earthquakes.length&&this.earthquakes.forEach(((e,a)=>{const t=e.geometry.coordinates,n=t[0],o=t[1],r=e.properties.mag,i=`\n                <div style="text-align:center">\n                  <strong>${e.properties.place}</strong><br>\n                  <span style="font-size: 1.2em; color: ${this.getColor(r)}">\n                    ‚óè Magnitud: ${r}\n                  </span><br>\n                  <small>${this.formatDate(e.properties.time)}</small>\n                </div>\n              `,s={radius:2.5*r,fillColor:this.getColor(r),color:"#000",weight:1,opacity:1,fillOpacity:.7},l=(e,a)=>{const t=j().circleMarker([e,a],s).bindPopup(i).addTo(this.map);this.markers[`${e},${a}`]=t},u=setTimeout((()=>{l(o,n),l(o,n-360),l(o,n+360)}),2*a);this.pendingTimeouts.push(u)}))},continuarBusqueda(){this.showConfirmDialog=!1,this.searchParams&&this.searchParams.allEarthquakes?(this.earthquakes=this.searchParams.allEarthquakes,this.searchParams.allEarthquakes=null,this.procesarSismos()):this.ejecutarBusqueda()},cancelarBusqueda(){this.showConfirmDialog=!1,this.searchParams=null,this.estimatedCount=0},ubicarSismo(e){const a=e.geometry.coordinates,t=a[1],n=a[0];this.map.flyTo([t,n],8,{duration:1.5});const o=this.markers[e.id];o&&o.openPopup()},formatDate(e){const a=new Date(e);return a.toLocaleDateString()+" "+a.toLocaleTimeString()}}},S=t(89);const O=(0,S.Z)(B,[["render",T],["__scopeId","data-v-1aefac13"]]);var $=O,E={name:"App",components:{HelloWorld:$}};const I=(0,S.Z)(E,[["render",r]]);var z=I;(0,n.ri)(z).mount("#app")}},a={};function t(n){var o=a[n];if(void 0!==o)return o.exports;var r=a[n]={exports:{}};return e[n].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(a,n,o,r){if(!n){var i=1/0;for(c=0;c<e.length;c++){n=e[c][0],o=e[c][1],r=e[c][2];for(var s=!0,l=0;l<n.length;l++)(!1&r||i>=r)&&Object.keys(t.O).every((function(e){return t.O[e](n[l])}))?n.splice(l--,1):(s=!1,r<i&&(i=r));if(s){e.splice(c--,1);var u=o();void 0!==u&&(a=u)}}return a}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[n,o,r]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){var e={143:0};t.O.j=function(a){return 0===e[a]};var a=function(a,n){var o,r,i=n[0],s=n[1],l=n[2],u=0;if(i.some((function(a){return 0!==e[a]}))){for(o in s)t.o(s,o)&&(t.m[o]=s[o]);if(l)var c=l(t)}for(a&&a(n);u<i.length;u++)r=i[u],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(c)},n=self["webpackChunkTeluricoApp"]=self["webpackChunkTeluricoApp"]||[];n.forEach(a.bind(null,0)),n.push=a.bind(null,n.push.bind(n))}();var n=t.O(void 0,[998],(function(){return t(3408)}));n=t.O(n)})();
//# sourceMappingURL=app.2ce27b23.js.map